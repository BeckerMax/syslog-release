---
name: syslog_forwarder

templates:
  pre-start.erb: bin/pre-start
  rsyslog.conf.erb: config/rsyslog.conf
  ca_cert.pem.erb: config/ca_cert.pem

consumes:
- name: syslog_storer
  type: syslog_storer
  optional: true

properties:
  address:
    description: IP or DNS address of the syslog server.
    example: logs4.papertrail.com
  port:
    description: Port of the syslog server.
    default: 514
  transport:
    default: udp
    description: One of ["udp", "tcp", "relp"].
  fallback_servers:
    description: "List of fallback servers to be used if the primary syslog server is down. Only tcp or relp protocols are supported. Each list entry should consist of \"address\", \"transport\" and \"port\" keys."
    default: []
    example:
    - address: logs5.papertrail.com
      port: 44312
      transport: tcp

  custom_rule:
    description: Custom rule for syslog event forwarder.
    default: ""

  tls_enabled:
    description: Set this to true to enable TLS.
    default: false
  permitted_peer:
    description: Accepted fingerprint (SHA1) or name of remote peer. Required if TLS is enabled.
    default: ""
    example: "*.papertrail.com"
  ca_cert:
    description: Trust these Certificate Authorities. Required if TLS is enabled.
    example: |
      -----BEGIN CERTIFICATE-----
      MIIClTCCAf4CCQDc6hJtvGB8RjANBgkqhkiG9w0BAQUFADCBjjELMAkGA1UEBhMC...
      -----END CERTIFICATE-----
