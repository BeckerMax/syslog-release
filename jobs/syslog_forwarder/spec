---
name: syslog_forwarder

templates:
  pre-start.erb: bin/pre-start
  rsyslog.conf.erb: config/rsyslog.conf
  ca_cert.pem.erb: config/ca_cert.pem

consumes:
- name: syslog_consumer
  type: syslog_consumer
  optional: true

properties:
  destination_address:
    description: IP or DNS address of the syslog drain
    example: logs4.papertrail.com
  port:
    description: Port of the syslog drain
    default: 514
  transport:
    default: udp
    description: One of ["udp", "tcp", "relp"].
  fallback_addresses:
    description: "Addresses of fallback servers to be used if the primary syslog server is down. Only tcp or relp are supported. Each list entry should consist of \"address\", \"transport\" and \"port\" keys. "
    default: []

  custom_rule:
    default: ""
    description: Custom rule for syslog event forwarder

  tls_enabled:
    default: false
    description: Set this to true to enable TLS.
  permitted_peer:
    default: ""
    description: Accepted fingerprint (SHA1) or name of remote peer. Required if TLS is enabled.
    example: "*.papertrail.com"
  ca_cert:
    description: Trust these Certificate Authorities. Required if TLS is enabled.
    example: |
      -----BEGIN CERTIFICATE-----
      MIIClTCCAf4CCQDc6hJtvGB8RjANBgkqhkiG9w0BAQUFADCBjjELMAkGA1UEBhMC
      ...
      ...
      .............................KTg8=
      -----END CERTIFICATE-----
